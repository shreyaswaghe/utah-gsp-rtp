#!/bin/env bash

#SBATCH --array=0-624
#SBATCH --job-name=rtp-test
#SBATCH --output=output/output-%j.txt
#SBATCH --mem=1800MB
#SBATCH --time=0-4:0:0
#SBATCH --nodes=1
#SBATCH --cpus-per-task=1
#SBATCH --partition=main

rate_reset_values=( 0.01 1.2595833333333333 2.5091666666666663 3.7587499999999996 5.008333333333333 6.257916666666667 7.507499999999999 8.757083333333332 10.006666666666666 11.25625 12.505833333333333 13.755416666666665 15.004999999999999 16.254583333333333 17.504166666666666 18.75375 20.003333333333334 21.252916666666668 22.5025 23.752083333333335 25.00166666666667 26.25125 27.500833333333333 28.750416666666666 30.0 )
rate_switch_values=( 0.01 0.21791666666666668 0.42583333333333334 0.63375 0.8416666666666667 1.0495833333333333 1.2575 1.4654166666666666 1.6733333333333333 1.88125 2.0891666666666664 2.297083333333333 2.505 2.7129166666666666 2.920833333333333 3.1287499999999997 3.3366666666666664 3.544583333333333 3.7525 3.9604166666666663 4.168333333333333 4.37625 4.5841666666666665 4.792083333333333 5.0 )

trial=${SLURM_ARRAY_TASK_ID}
rate_reset=${rate_reset_values[$(( trial % ${#rate_reset_values[@]} ))]}
trial=$(( trial / ${#rate_reset_values[@]} ))
rate_switch=${rate_switch_values[$(( trial % ${#rate_switch_values[@]} ))]}


## use ${rate_reset}, ${rate_switch} below

mkdir -p results/${SLURM_JOB_NAME}/

EXPERIMENT_NAME=${SLURM_JOB_NAME} ./bin/rtp_sim --v 0.2 --num_simulations 50 ${rate_reset} ${rate_switch}
